# Example HyperFleet Adapter deployment configuration
apiVersion: hyperfleet.redhat.com/v1alpha1
kind: AdapterConfig
metadata:
  name: adapter2
  labels:
    hyperfleet.io/adapter-type: adapter2
    hyperfleet.io/component: adapter
spec:
  adapter:
    version: "0.1.0"

  # Log the full merged configuration after load (default: false)
  debugConfig: true
  log:
    level: debug

  clients:
    hyperfleetApi:
      baseUrl: http://hyperfleet-api:8000
      version: v1
      timeout: 2s
      retryAttempts: 3
      retryBackoff: exponential

    broker:
      # These values are overridden at deploy time via env vars from Helm values
      subscriptionId: "placeholder"
      topic: "placeholder"

    maestro:
      grpcServerAddress: "maestro-grpc.maestro.svc.cluster.local:8090"
      
      # HTTPS server address for REST API operations (optional)
      # Environment variable: HYPERFLEET_MAESTRO_HTTP_SERVER_ADDRESS
      httpServerAddress: "http://maestro.maestro.svc.cluster.local:8000"
      
      # Source identifier for CloudEvents routing (must be unique across adapters)
      # Environment variable: HYPERFLEET_MAESTRO_SOURCE_ID
      sourceId: "hyperfleet-adapter"
      
      # Client identifier (defaults to sourceId if not specified)
      # Environment variable: HYPERFLEET_MAESTRO_CLIENT_ID
      clientId: "hyperfleet-adapter-client"
      insecure: true
      
      # Authentication configuration
      #auth:
      #  type: "tls"  # TLS certificate-based mTLS
      #  
      #  tlsConfig:
      #    # gRPC TLS configuration
      #    # Certificate paths (mounted from Kubernetes secrets)
      #    # Environment variable: HYPERFLEET_MAESTRO_CA_FILE
      #    caFile: "/etc/maestro/certs/grpc/ca.crt"
      #    
      #    # Environment variable: HYPERFLEET_MAESTRO_CERT_FILE
      #    certFile: "/etc/maestro/certs/grpc/client.crt"
      #    
      #    # Environment variable: HYPERFLEET_MAESTRO_KEY_FILE
      #    keyFile: "/etc/maestro/certs/grpc/client.key"
      #    
      #    # Server name for TLS verification
      #    # Environment variable: HYPERFLEET_MAESTRO_SERVER_NAME
      #    serverName: "maestro-grpc.maestro.svc.cluster.local"
      #    
      #    # HTTP API TLS configuration (may use different CA than gRPC)
      #    # If not set, falls back to caFile for backwards compatibility
      #    # Environment variable: HYPERFLEET_MAESTRO_HTTP_CA_FILE
      #    httpCaFile: "/etc/maestro/certs/https/ca.crt"

